<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<!-- Viewport Meta Tag for Mobile Site -->
	<!-- https://developer.mozilla.org/en-US/docs/Mozilla/Mobile/Viewport_meta_tag) -->
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<title>Backbite Algorithm for Sampling Hamiltonian Paths / Benjamin R. Bray</title>
	<link rel="stylesheet" href="../../css/style.css" />
	<link rel="stylesheet" href="../../css/article.css" />
	<link rel="stylesheet" href="../../css/pandoc-syntax.css" />
	<link rel="stylesheet" href="../../katex/katex.min.css" />
</head>

<!---- BODY ----------------------------------------------->
<body>
	<header id="header-box">
		<nav id="header">
			<ul id="header-nav">
				<li><a id="header-name" href="../../">Benjamin R. Bray</a></li>
				<li><a href="../../blog.html">WRITING</a></li>
				<li><a href="../../projects.html">PROJECTS</a></li>
				<li><a href="../../resources.html">RESOURCES</a></li>
				<li><a href="../../resume.pdf">RESUME</a></li>
			</ul>
		</nav>
	</header>
	
	<div id="pre-content">
    <!-- Banner -->
    
</div>

<div id="page">
<article id="content">
    <!-- Post Header -->
    <header class="article-header">
        <h1 class="article-title">Backbite Algorithm for Sampling Hamiltonian Paths</h1>
        <div class="article-info">
            <!-- Date -->
            <div class="article-date">
                Posted in algorithms on March 23, 2020 / Updated March 23, 2020
            </div>
            <!-- Tags / Tools -->
            <nav class="article-tags">
                
                
            </nav>
        </div>
        <div class="article-buttons">
            <!-- Demo URL -->
            
            <!-- GitHub URL -->
            
            <!-- PDF URL -->
            
        </div>
    </header>

    <!-- Body -->
    <section>
        <div class="toc"><h2>Table of Contents</h2>

</div>
<h2>
Backbite Algorithm for Sampling Hamiltonian Paths
</h2>
<script src="../../static/boggle/dictionary.js"></script>
<script src="../../static/boggle/WordTrie.js"></script>
<script src="../../static/boggle/boggle.js" defer></script>
<script src="https://d3js.org/d3.v5.min.js"></script>
<style>
line {
  shape-rendering: crispEdges;
}

.hampath {
  stroke-width: 5;
  fill: none;
}

/*#backbite-example {
  display: grid;
  grid: 1fr 1fr / 1fr 1fr;
  grid-gap: 1em 0;
  grid-auto-flow: row;
  max-width: 100%;
  counter-reset: fignum;
}

@media (max-width: 600px) {
  #backbite-example {
    grid: 1fr / 1fr;
  }
}*/

figure svg {
  display: block;
  margin: 0 auto;
  max-width: min(100%, 80vw);
}

tt {
  background-color: #ccc;
}


text.pathArrows {
  font-size: 48px;
  dominant-baseline: central;
  user-select: none;
}
</style>
<h3>
Hamiltonian Paths
</h3>
<p>
<p>A <a href="https://en.wikipedia.org/wiki/Hamiltonian_path"><dfn>Hamiltonian path</dfn></a> in a graph <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy="false">(</mo><mi>V</mi><mo separator="true">,</mo><mi>E</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G=(V,E)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span> is a path <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span> which visits each vertex exactly once. Determining whether a Hamiltonian path <a href="https://en.wikipedia.org/wiki/Hamiltonian_path_problem">exists</a> is an NP-complete decision problem, even if we restrict our attention to graphs with special structure, such as <a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.383.1078">subsets of grid graphs</a>.</p>
<p>A Hamiltonian graph may have more than one Hamiltonian path. Suppose we have a graph <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mo stretchy="false">(</mo><mi>V</mi><mo separator="true">,</mo><mi>E</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G=(V,E)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mclose">)</span></span></span></span> that we <b>know</b> is Hamiltonian, perhaps because we already have a Hamiltonian path <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span>. Is it possible to sample a random Hamiltonian path uniformly at random from <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">G</span></span></span></span>?</p>
<h3>
Animated Visualization
</h3>
<figure>
<svg id="backbite-demo">
</svg>
</figure>
<p>
<em>Minor Implementation Detail:</em> Although I use the backbite algorithm for <em>Long Word</em> randomization, I don't run the algorithm long enough to achieve a uniformly random Hamiltonian path.
</p>
<h3>
Algorithm Overview
</h3>
<figure role="group">
<div id="backbite-example" class="img-gallery col-2">
<figure>
<svg>
</svg>
<figcaption>
The backbite algorithm starts by randomly choosing one endpoint of a valid <span style="color:blue">hamiltonian path</span>.
</figcaption>
</figure>
<figure>
<svg>
</svg>
<figcaption>
Next, we <span style="color:green">connect</span> the endpoint to a random neighbor <tt>v</tt>. To maintain the Hamiltonian path, one of <tt>v</tt>'s two incident edges must be removed.
</figcaption>
</figure>
<figure>
<svg>
</svg>
<figcaption>
One choice will always disconnect the path, creating a <span style="color:red">loop</span>. So, we should choose the other edge!
</figcaption>
</figure>
<figure>
<svg>
</svg>
<figcaption>
Deleting the other edge results in a <span style="color:green">new hamiltonian path</span>, as desired. Notice that one endpoint has changed!
</figcaption>
</figure>
</div>
</figure>
<h3>
Implementation: Linked List Path
</h3>
<p>There are a number of different possible implementations, depending on how we choose to represent the graph <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">G</span></span></span></span> and the path <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span></span></span></span>.</p>
<dl>
<dt>
Adjacency Matrix
</dt>
<dd>
asdfasdf
</dd>
<dt>
Adjacency List
</dt>
<dd>
asdfasdf
</dd>
<dt>
Implicit Graph
</dt>
<dd>
asdfasdf
</dd>
</dl>
<h4>
Detail: Cycle Detection
</h3>
<h4>
Detail: Path Reversal
</h3>
<p>
As an aside, the problem of determining whether a graph <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">G</span></span></span></span> contains a Hamiltonian path (or cycle) is <a href="https://en.wikipedia.org/wiki/NP-completeness">NP-complete</a>. The standard proof involves a reduction from 3-SAT! By encoding the Hamiltonian path problem as a satisfiability problem, we can again use <tt>minisat.js</tt> to search for a solution.
</p>

    </section>
</article>
</div>


	<footer id="page-footer">
		<span style="float: left; vertical-align: middle">
			<img id="visitor-count" src="https://hitcounter.pythonanywhere.com/count/tag.svg" alt="Hits">
			Powered by <a href="http://jaspervdj.be/hakyll">Hakyll</a> and <a href="https://github.com/benrbray/benrbray.github.io-source">hosted on GitHub</a>.
		</span>
		<span style="float: right">
			Generated August 21, 2021
		</span>
	</footer>
<!--------------------------------------------------------->
</body>

</html>